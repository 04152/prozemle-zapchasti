{% extends "base.html" %}

{% block content %}
<div class="pa-card pa-card-filters">
    <h2>Каталоги запчастей техники</h2>

    <form method="get" class="pa-filters">
        <div class="pa-filters-row">
            <label>
                Группа техники
                <select name="group">
                    <option value="">Все</option>
                    {% for g in groups %}
                        <option value="{{ g }}"
                                {% if g == current_group %}selected{% endif %}>
                            {{ g }}
                        </option>
                    {% endfor %}
                </select>
            </label>

            <label>
                Модель (фрагмент)
                <input type="text" name="model"
                       value="{{ current_model or '' }}"
                       placeholder="Например: Нива, МТЗ-82, 5551">
            </label>
        </div>

        <div class="pa-filters-row">
            <label>
                Тип каталога
                <select name="catalog_type">
                    <option value="">Все</option>
                    {% for t in catalog_types %}
                        <option value="{{ t }}"
                                {% if t == current_type %}selected{% endif %}>
                            {{ t }}
                        </option>
                    {% endfor %}
                </select>
            </label>

            <label>
                Поиск по модели / описанию
                <input type="text" name="query"
                       value="{{ current_query or '' }}"
                       placeholder="Любое слово из описания">
            </label>
        </div>

        <div class="pa-filters-actions">
            <button type="submit" class="pa-button-primary">
                Найти
            </button>
            <a href="{{ url_for('index') }}" class="pa-button-secondary">
                Сбросить
            </a>
        </div>
    </form>
</div>

<div class="pa-card">
    <div class="pa-results-header">
        <h3>Результаты поиска</h3>
        <span class="pa-results-count">
            {{ records|length }} записей
        </span>
    </div>

    {% if records %}
        <div class="pa-table-wrapper">
            <table class="pa-table">
                <thead>
                <tr>
                    <th>Группа техники</th>
                    <th>Модели</th>
                    <th>Тип каталога</th>
                    <th>Описание</th>
                    <th>Ссылка</th>
                </tr>
                </thead>
                <tbody>
                {% for row in records %}
                    <tr>
                        <td>{{ row["Группа техники"] }}</td>
                        <td>{{ row["Модели"] }}</td>
                        <td>{{ row["Тип каталога"] }}</td>
                        <td class="pa-col-description">
                            {{ row["Описание"] }}
                        </td>
                        <td>
                            <a href="{{ row["Ссылка"] }}"
                               target="_blank"
                               rel="noopener"
                               class="pa-link-button">
                                Открыть
                            </a>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        <p>По заданным условиям ничего не найдено.
            Попробуй ослабить фильтры или изменить запрос.</p>
    {% endif %}
</div>
{% endblock %}
